function onBodyReady(){function j(a){$.ajax({url:ajax_site+"get_comments.php",data:{id:a},dataType:"json",type:"post",success:function(a){if(typeof a=="string"){b="<h2>"+a+"</h2>";$("#comments").html(b)}else{var b=$("#comments").html();b+="<li data-role='list-divider' role='heading'>Showing Comments</li>";for(idx in a){var c=a[idx][0][0];var d=a[idx][0][1];var e=a[idx][0][2];b+="<li data-corners='flase' data-shadow='false' data-theme='d'>";b+="<h3 class='ui-li-heading'>"+d+"</h3>";b+="<p class='ui-li-desc'>"+e+"<span style='float:right;'>Delete Comment   <input type='checkbox' rel='comment_del' id='"+c+"'</span><p>";b+="</li>"}$("#comments").html(b).listview("refresh")}}})}function h(a){$.ajax({url:ajax_site+"get_team.php",data:{user:a},dataType:"json",type:"post",success:function(a){for(idx in a){for(index in a[idx]){var b=a[idx][index][0];var c=a[idx][index][1];html='<option id="'+c+'" value="'+c+'">';html+=b;html+="</option>";$("#team_list_select").append(html)}}}})}function g(a,b){$.ajax({url:ajax_site+"todolist.php",type:"POST",dataType:"json",data:{query:a,user:b},success:function(a){if(typeof a==="string"){$(".no_todo").html(a)}else{var b=$("#todo_list").html();for(idx in a){var c=a[idx][0][0];var d=a[idx][0][1];var e=a[idx][0][2];var f=a[idx][0][3];var g=a[idx][0][4];b+='<li><input type="checkbox" rel="todo_del" id="'+c+'" style="z-index: 999;"/>Delete ToDo<a class="link_todo_details" id="'+c+'"><h2>';b+=e;b+="</h2><small> assigned to: "+d+" on: "+f+"</small></a>";b+="</li>"}$("#todo_list").html(b).listview("refresh")}}})}function f(a){$.ajax({url:ajax_site+"project_list.php",data:{email:a},dataType:"json",type:"POST",success:function(a){if(typeof a==="string"){$(".no_projects").html(a)}else{for(idx in a){var b="<h2>"+idx+" - <small>projects currently available.</small></h2>";$(".company_title").append(b);var c=$("#project_list").html();for(i in a[idx]){var d=a[idx][i][0];var e=a[idx][i][1];var f=a[idx][i][2];c+='<li><a class="link_to_todos" id="'+e+'"><h2>';c+=d;c+="</h2><small> created by: "+f+"</small></a>";c+="</li>"}}$("#project_list").html(c).listview("refresh")}}})}function e(){var a=navigator.network.connection.type;if(a==Connection.UNKNOWN||a==Connection.NONE){return false}else{return true}}login_attempts=0;ajax_site="http://www.nciairsoft.com/aria/";if(!e()){window.location.href="no_internet.html"}if(this_page=="no_internet"){if(e()){window.location.href="index.html"}}if(this_page=="Login"&&localStorage.getItem("user")){window.location.href="project_splash.html"}if(this_page=="Register"&&localStorage.getItem("user")){window.location.href="project_splash.html"}if(this_page=="project_splash"){var a=localStorage.getItem("user");if(a){f(a)}else{window.location.href="index.html"}}if(this_page=="todo_list"){var b=localStorage.getItem("user");var c=localStorage.getItem("proj");g(c,b);$(".texttodo_link").attr("id",c)}if(this_page=="new_text_todo"){var b=localStorage.getItem("user");h(b);var c=localStorage.getItem("proj")}if(this_page=="to_do_details"){var c=localStorage.getItem("todo");j(c)}var d=function(a){var b=new RegExp(/^(("[\w-+\s]+")|([\w-+]+(?:\.[\w-+]+)*)|("[\w-+\s]+")([\w-+]+(?:\.[\w-+]+)*))(@((?:[\w-+]+\.)*\w[\w-+]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return b.test(a)};$(".link_to_todos").live("click",function(a){var b=$(this).attr("id");localStorage.setItem("proj",b);window.location.href="todolist.html"});$(".link_todo_details").live("click",function(){var a=$(this).attr("id");localStorage.setItem("todo",a);window.location.href="todo_details.html"});$(".texttodo_link").live("click",function(){var a=$(this).attr("id");localStorage.setItem("todo",a);window.location.href="new_text_todo.html"});$("#logout").click(function(){localStorage.removeItem("user")});$("#login").live("click",function(a){uid=$("#username").val();pwd=$("#password").val();if(uid.length>0&&pwd.length>0&&d(uid)){if(login_attempts<5){$.ajax({url:ajax_site+"login.php",crossDomain:true,data:{uid:uid,pwd:pwd},type:"POST",success:function(a){console.log(a);if(a==1){localStorage.setItem("user",uid);window.location.href="project_splash.html"}else if(a==2){localStorage.setItem("user",uid);window.location.href="update_child_user.html"}else{console.log("You have entered the wrong details. Please Try Again!")}}})}}else{if(uid.length<1){$("#usrlabel").css("color","red")}if(pwd.length<1){$("#usrlabel").css("color","red")}$("#loginError").html("Login failed, check below");login_attempts++}if(login_attempts>=5){alert("You have failed to login "+login_attempts+" times. Your account is now locked")}});$("#register").live("click",function(a){email=$("#reg-username").val();password=$("#reg-password").val();confirm=$("#confirm-password").val();var b=true;if(!d(email)){$("#email-error").html("You did not enter a valid email<br/>").fadeOut(3e3);b=false}if(password!=confirm){$("#password-error").html("Your Passwords Did Not Match").fadeOut(3e3);b=false}if(password===""||confirm===""){$("#password-error").html("You left the password field blank").fadeOut(3e3);b=false}if(b){$.ajax({url:ajax_site+"register.php",crossDomain:true,data:{email:email,password:password},type:"POST",success:function(a){if(a==0){alert("User not created")}else if(a==1){localStorage.setItem("user",email);window.location.href="account.html"}else if(a==2){alert("User Exists")}}})}});$("#details").live("click",function(a){first_name=$("#f_name").val();second_name=$("#s_name").val();company=$("#comp").val();user_name=localStorage.getItem("user");if(first_name.length>0&&second_name.length>0&&company.length>0){$.ajax({url:ajax_site+"account_details.php",crossDomain:true,data:{user_name:user_name,first_name:first_name,second_name:second_name,company:company},type:"Post",success:function(a){if(a==1){alert("Account Creation is finished! Lets Get started on something fun");window.location.href="project_splash.html"}}})}else{alert("You left something blank")}});$("#create").live("click",function(){var a=$("#projectname").val();var b=localStorage.getItem("user");if(a.length>0){$.ajax({url:ajax_site+"create_project.php",data:{name:a,user:b},type:"POST",success:function(a){if(a==1){alert("Project Created!");window.location.href="project_splash.html"}else{alert("Project was not created! Please try again.")}}})}else{alert("You must enter a project name")}});$("#invite").live("click",function(){var a=$("#childemail").val();var b=localStorage.getItem("user");var c=true;if(!d(a)){c=false}if(a.length<1){c=false}if(c){$.ajax({url:ajax_site+"invite.php",data:{child:a,parent:b},type:"POST",success:function(a){if(a==1){alert("Thank you for inviting a team mate. They will now be sent an invite");window.location.href="project_splash.html"}else{alert("Ooops! Something went wrong. Try add a team mate again")}}})}});$("#update_details").live("click",function(){var a=$("#_fname").val();var b=$("#_sname").val();var c=$("#_cp").val();var d=localStorage.getItem("user");var e=true;if(a.length==0){e=false}if(b.length==0){e=false}if(c.length==0){e=false}if(e){$.ajax({url:ajax_site+"update_details.php",data:{email:d,fname:a,sname:b,pwd:c},type:"POST",success:function(a){if(a==1){window.location.href="project_splash.html"}else{alert("Oooops! Something went wrong. Please try again.")}}})}else{alert("All fields must be filed in!")}});$("#add_text_todo").live("click",function(){var a=c;var b=$("#title").val();var d=$("#team_list_select").val();var e=localStorage.getItem("user");var f=true;if(b.length==0){alert("You must enter a title");f=false}if(d=="no"){alert("You must asign this to a user");f=false}if(f){$.ajax({url:ajax_site+"add_text_todo.php",data:{project:a,title:b,assign:d,user:e},type:"post",success:function(a){if(a==1){window.location.href="todolist.html"}else{alert("Ooops! Something went wrong. Please try again.")}}})}});$("input[rel=todo_del]").live("click",function(){$this=$(this);if($this.prop("checked",true)){var a=$this.attr("id");var b=$this.parent().parent().parent().parent().parent().parent().parent();b.fadeOut(300,function(){b.remove()});$.ajax({url:ajax_site+"remove_todo_and_comments.php",type:"POST",data:{id:a},success:function(a){if(a==0){window.location.href="todolist.html"}}})}});$("input[rel=comment_del]").live("click",function(){$this=$(this);if($this.prop("checked",true)){var a=$this.attr("id");var b=$this.parent().parent().parent();b.fadeOut(300,function(){b.remove()});$.ajax({url:ajax_site+"remove_comments.php",type:"POST",data:{id:a},success:function(a){if(a==0){alert("Ooops! Something went wrong!")}}})}});$("#submit_comment").live("click",function(){var a=$("#comment").val();var b=true;var d=localStorage.getItem("user");if(a.length<1){alert("You must enter text into the box");b=false}if(b){$.ajax({url:ajax_site+"add_comment.php",data:{comment:a,user:d,todo:c},type:"POST",success:function(a){if(a==1){window.location.reload()}else if(a==0){alert("Something went wrong. Try again!")}}})}})}function onBodyLoad(){document.addEventListener("deviceready",onBodyReady,false)}